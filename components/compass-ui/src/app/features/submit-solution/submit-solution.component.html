<div class="breadcrumb">
  <p-breadcrumb [model]="[
    { label: 'Home', routerLink: '/' },
    { label: 'Catalog', routerLink: '/items' },
    { label: 'Submit New Item' }
  ]"></p-breadcrumb>
</div>

<div class="submit-solution">
  <h1>Submit New Item</h1>

  <p-messages></p-messages>

  <div *ngIf="isLoggedIn; else loginToSubmit">
    <form [formGroup]="solutionForm" (ngSubmit)="onSubmit()" class="p-fluid">
      <div class="section-card">
        <div class="section-header">
          <h3><i class="pi pi-info-circle"></i> Basic Information</h3>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="group">Group</label>
            <p-dropdown id="group" [options]="groups" formControlName="group" optionLabel="name" optionValue="name"
              [style]="{'width':'100%'}" placeholder="Select a group"></p-dropdown>
          </div>
          <div class="form-field">
            <label for="category">Category *</label>
            <p-dropdown id="category" [options]="categories" formControlName="category" optionLabel="name"
              optionValue="name" [style]="{'width':'100%'}" placeholder="Select a category"></p-dropdown>
          </div>
          <div class="form-field">
            <label for="name">Name *</label>
            <input id="name" type="text" pInputText formControlName="name" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="tags">Tags</label>
            <p-chips id="tags" formControlName="tags" placeholder="Enter a tag and press Enter" [addOnBlur]="true"
              [separator]="','" [allowDuplicate]="false">
            </p-chips>
          </div>
          <div class="form-field">
            <label for="version">Version *</label>
            <input id="version" type="text" pInputText formControlName="version" />
          </div>
          <div class="form-field">
            <label for="logo">Logo Asset Name</label>
            <input id="logo" type="text" pInputText formControlName="logo" placeholder="Enter logo path or URL" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="brief">Brief Description * (max 200 characters)</label>
            <textarea id="brief" pInputTextarea formControlName="brief" [rows]="2" [maxlength]="200"
              placeholder="Enter a brief description of your technology"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="description">Description *</label>
            <textarea id="description" pInputTextarea formControlName="description" [rows]="5" [autoResize]="true"
              placeholder="Please provide a detailed description of the technology, including its main features, use cases, and any special requirements."></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="how_to_use">How to Use</label>
            <textarea id="how_to_use" pInputTextarea formControlName="how_to_use" [rows]="4" [autoResize]="true"
              placeholder="Instructions on how to use the solution (markdown supported)"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="how_to_use_url">How to Use URL</label>
            <input id="how_to_use_url" type="url" pInputText formControlName="how_to_use_url" placeholder="https://" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="faq">FAQ</label>
            <textarea id="faq" pInputTextarea formControlName="faq" [rows]="4" [autoResize]="true"
              placeholder="Frequently asked questions about the solution (markdown supported)"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="about">About</label>
            <textarea id="about" pInputTextarea formControlName="about" [rows]="4" [autoResize]="true"
              placeholder="Additional information about the solution (markdown supported)"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="upskilling">Upskilling</label>
            <textarea id="upskilling" pInputTextarea formControlName="upskilling" [rows]="4" [autoResize]="true"
              placeholder="Information on how to gain skills with this solution (training, certifications, etc., markdown supported)"></textarea>
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="section-header">
          <h3><i class="pi pi-users"></i> Product Owner Information</h3>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="department">Department *</label>
            <p-dropdown id="department" [options]="departments" formControlName="department" [style]="{'width':'100%'}"
              placeholder="Select a department"></p-dropdown>
          </div>
          <div class="form-field">
            <label for="team">Team Name *</label>
            <input id="team" type="text" pInputText formControlName="team" />
          </div>
          <div class="form-field">
            <label for="team_email">Team Email *</label>
            <input id="team_email" type="email" pInputText formControlName="team_email" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="maintainer_id">Product Owner ID *</label>
            <input id="maintainer_id" type="text" pInputText formControlName="maintainer_id" />
          </div>
          <div class="form-field">
            <label for="maintainer_name">Product Owner Name *</label>
            <input id="maintainer_name" type="text" pInputText formControlName="maintainer_name" />
          </div>
          <div class="form-field">
            <label for="maintainer_email">Product Owner Email *</label>
            <input id="maintainer_email" type="email" pInputText formControlName="maintainer_email" />
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="section-header">
          <h3><i class="pi pi-link"></i> Links & Resources</h3>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="official_website">Official Website</label>
            <input id="official_website" type="url" pInputText formControlName="official_website"
              placeholder="https://" />
          </div>
          <div class="form-field">
            <label for="documentation_url">Documentation URL</label>
            <input id="documentation_url" type="url" pInputText formControlName="documentation_url"
              placeholder="https://" />
          </div>

          <div class="form-field">
            <label for="support_url">Support URL</label>
            <input id="support_url" type="url" pInputText formControlName="support_url" placeholder="https://" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="demo_url">Demo URL</label>
            <input id="demo_url" type="url" pInputText formControlName="demo_url" placeholder="https://" />
          </div>
          <div class="form-field">
            <label for="provider_type">Product Type</label>
            <p-dropdown id="provider_type" [options]="providerTypeOptions" formControlName="provider_type"
              optionLabel="label" optionValue="value" [style]="{'width':'100%'}"
              placeholder="Select product type"></p-dropdown>
          </div>
          <div class="form-field">
            <label for="vendor_product_url">Vendor Product URL</label>
            <input id="vendor_product_url" type="url" pInputText formControlName="vendor_product_url"
              placeholder="https://" />
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="section-header">
          <h3><i class="pi pi-chart-bar"></i> Status Information</h3>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="stage">Development Stage *</label>
            <p-dropdown id="stage" [options]="stageOptions" formControlName="stage" optionLabel="label"
              optionValue="value" [style]="{'width':'100%'}" placeholder="Select stage"></p-dropdown>
          </div>
          <div class="form-field">
            <label for="recommend_status">Recommend Status *</label>
            <p-dropdown id="recommend_status" [options]="recommendStatusOptions" formControlName="recommend_status"
              optionLabel="label" optionValue="value" [style]="{'width':'100%'}"
              placeholder="Select status"></p-dropdown>
          </div>
        </div>
        <div class="form-row" *ngIf="solutionForm.get('recommend_status')?.value === 'HOLD'">
          <div class="form-field">
            <label for="replaced_by">Replaced By</label>
            <input id="replaced_by" type="text" pInputText formControlName="replaced_by" 
              [placeholder]="'default solution'"
              [value]="solutionForm.get('replaced_by')?.value || 'default solution'" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="adoption_complexity">Adoption Complexity *</label>
            <p-dropdown id="adoption_complexity" [options]="adoptionComplexityOptions"
              formControlName="adoption_complexity" optionLabel="label" optionValue="value" [style]="{'width':'100%'}"
              placeholder="Select adoption complexity"></p-dropdown>
          </div>
          <div class="form-field">
            <label for="adoption_level">Adoption Level *</label>
            <p-dropdown id="adoption_level" [options]="adoptionLevelOptions" formControlName="adoption_level"
              optionLabel="label" optionValue="value" [style]="{'width':'100%'}"
              placeholder="Select adoption level"></p-dropdown>
          </div>
          <div class="form-field">
            <label for="adoption_user_count">Estimated User Count *</label>
            <p-inputNumber id="adoption_user_count" formControlName="adoption_user_count" [min]="0"
              placeholder="Enter number of users"></p-inputNumber>
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="section-header">
          <h3><i class="pi pi-list"></i> Pros & Cons</h3>
        </div>
        <div class="form-row">
          <div class="form-field">
            <label for="pros">Pros *</label>
            <textarea id="pros" pInputTextarea formControlName="pros" [rows]="5" [autoResize]="true"
              placeholder="Enter one advantage per line. For example:&#10;Easy to use&#10;Good performance&#10;Well documented"></textarea>
          </div>
          <div class="form-field">
            <label for="cons">Cons *</label>
            <textarea id="cons" pInputTextarea formControlName="cons" [rows]="5" [autoResize]="true"
              placeholder="Enter one disadvantage per line. For example:&#10;High learning curve&#10;Limited customization&#10;Complex setup"></textarea>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <p-button type="submit" label="Submit" icon="pi pi-check" [loading]="submitting"
          [disabled]="!solutionForm.valid || submitting" styleClass="p-button-primary p-button-rounded">
        </p-button>
      </div>
    </form>
  </div>

  <ng-template #loginToSubmit>
    <div class="login-prompt">
      <p>Please <a href="javascript:void(0)" (click)="showLoginDialog()">sign in</a> to submit an item.</p>
    </div>
  </ng-template>
</div>